<div class="cc-page-course-grade-export">

  <div data-ng-if="appState === 'loading'">
    <div data-ng-hide="jobStatus" class="cc-page-course-grade-export-notice-pending-request">
      <i class="fa fa-spinner fa-spin"></i>
      Sending preparation request...
    </div>

    <div data-ng-if="jobStatus === 'New'" class="cc-page-course-grade-export-notice-pending-request">
      <i class="fa fa-spinner fa-spin"></i>
      Preparation request sent. Awaiting processing....
    </div>

    <div data-ng-if="jobStatus">
      <div data-ng-include src="'canvas_embedded/_shared/progress_bar.html'"></div>
    </div>
  </div>

  <div data-ng-if="appState === 'ready'">
    <div class="row collapse">
      <div class="medium-12 columns">
        <i class="fa fa-long-arrow-left"></i>
        <button class="cc-button-link" data-ng-click="goToGradebook()">Back to Gradebook</button>
      </div>
    </div>

    <div class="row collapse">
      <div class="medium-5 columns end">
        <div class="cc-page-course-grade-export-header">
          <h1>What would you like to download?</h1>
        </div>
      </div>
    </div>

    <div class="row collapse" data-ng-show="officialSections.length > 1">
      <div class="medium-4 columns">
        <div class="cc-page-course-grade-export-section">
          <div class="cc-left">
            <label for="course-sections">Select Section:</label>
          </div>
          <div class="cc-left cc-page-course-grade-export-section-select">
            <select id="course-sections" data-ng-model="selectedSection" data-ng-options="section as section.display_name for section in officialSections"></select>
          </div>
        </div>
      </div>
    </div>

    <div class="row collapse">
      <div class="medium-5 columns end">
        <h2 class="cc-page-course-grade-export-download-header">Current Grades Download</h2>
        <p class="cc-page-course-grade-export-download-description">
          Current grades download ignores unsubmitted assignments when calculating grades.
          Use this download when you want to excuse unsubmitted assignments.
        </p>
        <a data-ng-href="/api/academics/canvas/egrade_export/download/{{canvasCourseId}}.csv?ccn={{selectedSection.course_cntl_num}}&term_cd={{selectedSection.term_cd}}&term_yr={{selectedSection.term_yr}}&type=current" target="_self" class="cc-button cc-page-course-grade-export-download-button">Download Current Grades</a>
      </div>
    </div>

    <div class="row collapse">
      <div class="medium-5 columns">
        <h2 class="cc-page-course-grade-export-download-header">Final Grades Download</h2>
        <p class="cc-page-course-grade-export-download-description">
          Final grades download counts unsubmitted assignments as zeroes when calculating grades.
          Use this download when you want to include all unsubmitted assignments as part of the grade.
        </p>
        <a data-ng-href="/api/academics/canvas/egrade_export/download/{{canvasCourseId}}.csv?ccn={{selectedSection.course_cntl_num}}&term_cd={{selectedSection.term_cd}}&term_yr={{selectedSection.term_yr}}&type=final" target="_self" class="cc-button cc-page-course-grade-export-download-button">Download Final Grades</a>
      </div>
    </div>

    <div class="row collapse">
      <div class="medium-12 columns">
        <p class="cc-page-course-grade-export-more-info-container">
          For more information, see <a href="http://ets.berkeley.edu/bcourses/how-do-i-submit-grades-e-grades-bcourses">How do I Submit Grades to E-Grades from bCourses?</a>
        </p>
      </div>
    </div>

    <div class="row collapse">
      <div class="medium-12 columns cc-page-course-grade-export-grade-link" data-ng-if="canvasCourseId && parentHostUrl">
        <button class="cc-button-link" data-ng-click="goToGradebook()">Back to Gradebook</a>
      </div>
    </div>
  </div>

  <div data-ng-if="appState === 'error'" class="cc-page-course-grade-export-error-display">

    <!-- Standard Error -->
    <div data-ng-if="errorStatus">
      <p>
        <i class="fa fa-warning"></i>
        <span data-ng-bind="errorStatus"></span>
      </p>
      <p data-ng-if="contactSupport">Please contact <a href="http://ets.berkeley.edu/bcourses/support">bCourses support</a> for further assistance.</p>
      <p data-ng-if="unexpectedContactSupport">If this is not expected, please contact <a href="http://ets.berkeley.edu/bcourses/support">bCourses support</a> for further assistance.</p>
    </div>

    <!-- No Grading Standard Enabled -->
    <div data-ng-if="!errorStatus && noGradingStandardEnabled">

      <div class="row collapse">
        <div class="medium-12 columns">
          <i class="fa fa-long-arrow-left"></i>
          <button class="cc-button-link" data-ng-click="goToGradebook()">Back to Gradebook</button>
        </div>
      </div>

      <h1>Download E-Grades (.csv)</h1>
      <div class="row collapse">
        <div class="medium-12 columns">
          <p>
            <i class="fa fa-warning cc-page-course-grade-export-warning"></i>
            ACTION REQUIRED!
          </p>
          <p>
            Letter grades are required by the E-Grades system. A grading scheme must be applied to calculate
            student letter grades.
          </p>
          <p>
            Please edit and enable the grading scheme in the <button class="cc-button-link" data-ng-click="goToCourseDetails()">course details</button> page for this course site.
            You may need to choose an alternative grading scheme for your course site other than the default scheme. Once this
            step is completed, return here and try again.
          </p>
          <p>
            For more information see <a href="http://guides.instructure.com/m/4152/l/57089-how-do-i-enable-a-grading-scheme-for-my-course">How do I enable a grading scheme for my course?</a>
          </p>
        </div>
      </div>
    </div>
  </div>

</div>
